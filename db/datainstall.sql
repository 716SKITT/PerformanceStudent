-- Full data reset + realistic seed for demo.

TRUNCATE TABLE
  "FinalGrade",
  "GradeSheet",
  "Grade",
  "Attendance",
  "Assignment",
  "DisciplineOffering",
  "Discipline",
  "Student",
  "Proffessor",
  "StudentGroup",
  "Semester",
  "AcademicYear",
  "UserAccount",
  "Course"
RESTART IDENTITY CASCADE;

-- Optional legacy courses (for compatibility in some screens).
INSERT INTO "Course" ("Id", "Name") VALUES
  (1, 'Информационные системы и программирование'),
  (2, 'Логистика'),
  (3, 'Философия');

-- Academic years
INSERT INTO "AcademicYear" ("Id", "StartYear", "EndYear") VALUES
  ('10000000-0000-0000-0000-000000000001', 2025, 2026),
  ('10000000-0000-0000-0000-000000000002', 2026, 2027);

-- Semesters
INSERT INTO "Semester" ("Id", "Number", "AcademicYearId") VALUES
  ('11000000-0000-0000-0000-000000000001', 1, '10000000-0000-0000-0000-000000000001'),
  ('11000000-0000-0000-0000-000000000002', 2, '10000000-0000-0000-0000-000000000001'),
  ('11000000-0000-0000-0000-000000000003', 1, '10000000-0000-0000-0000-000000000002'),
  ('11000000-0000-0000-0000-000000000004', 2, '10000000-0000-0000-0000-000000000002');

-- Groups
INSERT INTO "StudentGroup" ("Id", "Name", "StudyYear", "AcademicYearId") VALUES
  ('12000000-0000-0000-0000-000000000001', 'ИС-221', 2, '10000000-0000-0000-0000-000000000001'),
  ('12000000-0000-0000-0000-000000000002', 'ИС-222', 2, '10000000-0000-0000-0000-000000000001'),
  ('12000000-0000-0000-0000-000000000003', 'Л-121', 1, '10000000-0000-0000-0000-000000000001'),
  ('12000000-0000-0000-0000-000000000004', 'Ф-101', 1, '10000000-0000-0000-0000-000000000001');

-- Professors
INSERT INTO "Proffessor" ("Id", "FirstName", "LastName", "Gender", "EnrollmentDate", "DateOfBirth", "CourseId") VALUES
  ('13000000-0000-0000-0000-000000000001', 'Игорь', 'Смирнов', 1, TIMESTAMPTZ '2020-09-01 00:00:00+00', TIMESTAMPTZ '1983-03-12 00:00:00+00', 1),
  ('13000000-0000-0000-0000-000000000002', 'Елена', 'Кузнецова', 0, TIMESTAMPTZ '2021-09-01 00:00:00+00', TIMESTAMPTZ '1987-07-04 00:00:00+00', 1),
  ('13000000-0000-0000-0000-000000000003', 'Олег', 'Власов', 1, TIMESTAMPTZ '2019-09-01 00:00:00+00', TIMESTAMPTZ '1980-02-19 00:00:00+00', 2),
  ('13000000-0000-0000-0000-000000000004', 'Марина', 'Орлова', 0, TIMESTAMPTZ '2018-09-01 00:00:00+00', TIMESTAMPTZ '1979-11-23 00:00:00+00', 3);

-- Students
INSERT INTO "Student" ("Id", "FirstName", "LastName", "Gender", "EnrollmentDate", "DateOfBirth", "CourseId", "StudentGroupId") VALUES
  ('14000000-0000-0000-0000-000000000001', 'Артем', 'Ильин', 1, TIMESTAMPTZ '2024-09-01 00:00:00+00', TIMESTAMPTZ '2006-01-14 00:00:00+00', 1, '12000000-0000-0000-0000-000000000001'),
  ('14000000-0000-0000-0000-000000000002', 'Никита', 'Романов', 1, TIMESTAMPTZ '2024-09-01 00:00:00+00', TIMESTAMPTZ '2006-05-29 00:00:00+00', 1, '12000000-0000-0000-0000-000000000001'),
  ('14000000-0000-0000-0000-000000000003', 'Полина', 'Лебедева', 0, TIMESTAMPTZ '2024-09-01 00:00:00+00', TIMESTAMPTZ '2006-09-03 00:00:00+00', 1, '12000000-0000-0000-0000-000000000002'),
  ('14000000-0000-0000-0000-000000000004', 'Дарья', 'Федорова', 0, TIMESTAMPTZ '2024-09-01 00:00:00+00', TIMESTAMPTZ '2006-12-16 00:00:00+00', 1, '12000000-0000-0000-0000-000000000002'),
  ('14000000-0000-0000-0000-000000000005', 'Кирилл', 'Жуков', 1, TIMESTAMPTZ '2025-09-01 00:00:00+00', TIMESTAMPTZ '2007-04-20 00:00:00+00', 2, '12000000-0000-0000-0000-000000000003'),
  ('14000000-0000-0000-0000-000000000006', 'Анна', 'Швец', 0, TIMESTAMPTZ '2025-09-01 00:00:00+00', TIMESTAMPTZ '2007-08-11 00:00:00+00', 2, '12000000-0000-0000-0000-000000000003'),
  ('14000000-0000-0000-0000-000000000007', 'София', 'Семенова', 0, TIMESTAMPTZ '2025-09-01 00:00:00+00', TIMESTAMPTZ '2007-03-07 00:00:00+00', 3, '12000000-0000-0000-0000-000000000004'),
  ('14000000-0000-0000-0000-000000000008', 'Глеб', 'Титов', 1, TIMESTAMPTZ '2025-09-01 00:00:00+00', TIMESTAMPTZ '2007-10-01 00:00:00+00', 3, '12000000-0000-0000-0000-000000000004');

-- Disciplines (ControlType: 0 exam, 1 pass/fail, 2 diff pass)
INSERT INTO "Discipline" ("Id", "Name", "Hours", "ControlType") VALUES
  ('15000000-0000-0000-0000-000000000001', 'Программирование на C#', 108, 0),
  ('15000000-0000-0000-0000-000000000002', 'Базы данных', 96, 0),
  ('15000000-0000-0000-0000-000000000003', 'Архитектура информационных систем', 72, 2),
  ('15000000-0000-0000-0000-000000000004', 'Управление цепями поставок', 72, 0),
  ('15000000-0000-0000-0000-000000000005', 'Складская логистика', 64, 2),
  ('15000000-0000-0000-0000-000000000006', 'История философии', 72, 0),
  ('15000000-0000-0000-0000-000000000007', 'Этика и культура мышления', 54, 1);

-- Offerings (group curriculum with teachers)
INSERT INTO "DisciplineOffering" ("Id", "DisciplineId", "SemesterId", "StudentGroupId", "ProffessorId") VALUES
  ('16000000-0000-0000-0000-000000000001', '15000000-0000-0000-0000-000000000001', '11000000-0000-0000-0000-000000000001', '12000000-0000-0000-0000-000000000001', '13000000-0000-0000-0000-000000000001'),
  ('16000000-0000-0000-0000-000000000002', '15000000-0000-0000-0000-000000000002', '11000000-0000-0000-0000-000000000001', '12000000-0000-0000-0000-000000000001', '13000000-0000-0000-0000-000000000002'),
  ('16000000-0000-0000-0000-000000000003', '15000000-0000-0000-0000-000000000003', '11000000-0000-0000-0000-000000000002', '12000000-0000-0000-0000-000000000001', '13000000-0000-0000-0000-000000000001'),
  ('16000000-0000-0000-0000-000000000004', '15000000-0000-0000-0000-000000000001', '11000000-0000-0000-0000-000000000001', '12000000-0000-0000-0000-000000000002', '13000000-0000-0000-0000-000000000001'),
  ('16000000-0000-0000-0000-000000000005', '15000000-0000-0000-0000-000000000002', '11000000-0000-0000-0000-000000000001', '12000000-0000-0000-0000-000000000002', '13000000-0000-0000-0000-000000000002'),
  ('16000000-0000-0000-0000-000000000006', '15000000-0000-0000-0000-000000000004', '11000000-0000-0000-0000-000000000001', '12000000-0000-0000-0000-000000000003', '13000000-0000-0000-0000-000000000003'),
  ('16000000-0000-0000-0000-000000000007', '15000000-0000-0000-0000-000000000005', '11000000-0000-0000-0000-000000000002', '12000000-0000-0000-0000-000000000003', '13000000-0000-0000-0000-000000000003'),
  ('16000000-0000-0000-0000-000000000008', '15000000-0000-0000-0000-000000000006', '11000000-0000-0000-0000-000000000001', '12000000-0000-0000-0000-000000000004', '13000000-0000-0000-0000-000000000004'),
  ('16000000-0000-0000-0000-000000000009', '15000000-0000-0000-0000-000000000007', '11000000-0000-0000-0000-000000000002', '12000000-0000-0000-0000-000000000004', '13000000-0000-0000-0000-000000000004');

-- Assignments
INSERT INTO "Assignment" ("Title", "Description", "DueDate", "CourseId", "DisciplineOfferingId") VALUES
  ('Лабораторная 1: Коллекции', 'Реализовать управление списком задач с LINQ', TIMESTAMPTZ '2025-10-15 00:00:00+00', 1, '16000000-0000-0000-0000-000000000001'),
  ('Лабораторная 2: EF Core', 'CRUD API для каталога книг', TIMESTAMPTZ '2025-11-05 00:00:00+00', 1, '16000000-0000-0000-0000-000000000001'),
  ('Практика: Нормализация', 'Построить ER-модель и 3НФ', TIMESTAMPTZ '2025-10-20 00:00:00+00', 1, '16000000-0000-0000-0000-000000000002'),
  ('Кейс: SQL-запросы', 'Аналитические запросы по продажам', TIMESTAMPTZ '2025-11-12 00:00:00+00', 1, '16000000-0000-0000-0000-000000000002'),
  ('Лабораторная 1: REST API', 'Мини-сервис для заказов', TIMESTAMPTZ '2025-10-18 00:00:00+00', 1, '16000000-0000-0000-0000-000000000004'),
  ('Практика: WMS', 'Оптимизация размещения на складе', TIMESTAMPTZ '2025-10-22 00:00:00+00', 2, '16000000-0000-0000-0000-000000000006'),
  ('Эссе: Античная философия', 'Сравнение Платона и Аристотеля', TIMESTAMPTZ '2025-10-25 00:00:00+00', 3, '16000000-0000-0000-0000-000000000008');

-- Grades (assignment IDs start from 1 after TRUNCATE RESTART IDENTITY)
INSERT INTO "Grade" ("StudentId", "AssignmentId", "Score", "DisciplineOfferingId") VALUES
  ('14000000-0000-0000-0000-000000000001', 1, 91, '16000000-0000-0000-0000-000000000001'),
  ('14000000-0000-0000-0000-000000000002', 1, 84, '16000000-0000-0000-0000-000000000001'),
  ('14000000-0000-0000-0000-000000000001', 2, 88, '16000000-0000-0000-0000-000000000001'),
  ('14000000-0000-0000-0000-000000000002', 2, 79, '16000000-0000-0000-0000-000000000001'),
  ('14000000-0000-0000-0000-000000000001', 3, 90, '16000000-0000-0000-0000-000000000002'),
  ('14000000-0000-0000-0000-000000000002', 3, 76, '16000000-0000-0000-0000-000000000002'),
  ('14000000-0000-0000-0000-000000000003', 5, 93, '16000000-0000-0000-0000-000000000004'),
  ('14000000-0000-0000-0000-000000000004', 5, 85, '16000000-0000-0000-0000-000000000004'),
  ('14000000-0000-0000-0000-000000000005', 6, 87, '16000000-0000-0000-0000-000000000006'),
  ('14000000-0000-0000-0000-000000000006', 6, 81, '16000000-0000-0000-0000-000000000006'),
  ('14000000-0000-0000-0000-000000000007', 7, 95, '16000000-0000-0000-0000-000000000008'),
  ('14000000-0000-0000-0000-000000000008', 7, 82, '16000000-0000-0000-0000-000000000008');

-- Attendance
INSERT INTO "Attendance" ("StudentId", "Date", "IsPresent", "DisciplineOfferingId") VALUES
  ('14000000-0000-0000-0000-000000000001', TIMESTAMPTZ '2025-09-10 00:00:00+00', TRUE, '16000000-0000-0000-0000-000000000001'),
  ('14000000-0000-0000-0000-000000000002', TIMESTAMPTZ '2025-09-10 00:00:00+00', FALSE, '16000000-0000-0000-0000-000000000001'),
  ('14000000-0000-0000-0000-000000000001', TIMESTAMPTZ '2025-09-17 00:00:00+00', TRUE, '16000000-0000-0000-0000-000000000001'),
  ('14000000-0000-0000-0000-000000000002', TIMESTAMPTZ '2025-09-17 00:00:00+00', TRUE, '16000000-0000-0000-0000-000000000001'),
  ('14000000-0000-0000-0000-000000000005', TIMESTAMPTZ '2025-09-11 00:00:00+00', TRUE, '16000000-0000-0000-0000-000000000006'),
  ('14000000-0000-0000-0000-000000000006', TIMESTAMPTZ '2025-09-11 00:00:00+00', TRUE, '16000000-0000-0000-0000-000000000006'),
  ('14000000-0000-0000-0000-000000000007', TIMESTAMPTZ '2025-09-12 00:00:00+00', TRUE, '16000000-0000-0000-0000-000000000008'),
  ('14000000-0000-0000-0000-000000000008', TIMESTAMPTZ '2025-09-12 00:00:00+00', TRUE, '16000000-0000-0000-0000-000000000008');

-- Grade sheets and final grades
INSERT INTO "GradeSheet" ("Id", "DisciplineOfferingId", "CreatedAt", "ClosedAt", "Status") VALUES
  ('17000000-0000-0000-0000-000000000001', '16000000-0000-0000-0000-000000000001', TIMESTAMPTZ '2025-12-20 00:00:00+00', TIMESTAMPTZ '2025-12-28 00:00:00+00', 1),
  ('17000000-0000-0000-0000-000000000002', '16000000-0000-0000-0000-000000000002', TIMESTAMPTZ '2025-12-20 00:00:00+00', TIMESTAMPTZ '2025-12-28 00:00:00+00', 1),
  ('17000000-0000-0000-0000-000000000003', '16000000-0000-0000-0000-000000000006', TIMESTAMPTZ '2025-12-22 00:00:00+00', NULL, 0),
  ('17000000-0000-0000-0000-000000000004', '16000000-0000-0000-0000-000000000008', TIMESTAMPTZ '2025-12-23 00:00:00+00', TIMESTAMPTZ '2025-12-29 00:00:00+00', 1);

INSERT INTO "FinalGrade" ("Id", "GradeSheetId", "StudentId", "FinalScore", "FinalMark", "UpdatedAt") VALUES
  ('18000000-0000-0000-0000-000000000001', '17000000-0000-0000-0000-000000000001', '14000000-0000-0000-0000-000000000001', 89.5, 'Отлично', TIMESTAMPTZ '2025-12-28 00:00:00+00'),
  ('18000000-0000-0000-0000-000000000002', '17000000-0000-0000-0000-000000000001', '14000000-0000-0000-0000-000000000002', 81.5, 'Хорошо', TIMESTAMPTZ '2025-12-28 00:00:00+00'),
  ('18000000-0000-0000-0000-000000000003', '17000000-0000-0000-0000-000000000002', '14000000-0000-0000-0000-000000000001', 90.0, 'Отлично', TIMESTAMPTZ '2025-12-28 00:00:00+00'),
  ('18000000-0000-0000-0000-000000000004', '17000000-0000-0000-0000-000000000002', '14000000-0000-0000-0000-000000000002', 76.0, 'Хорошо', TIMESTAMPTZ '2025-12-28 00:00:00+00'),
  ('18000000-0000-0000-0000-000000000005', '17000000-0000-0000-0000-000000000003', '14000000-0000-0000-0000-000000000005', 87.0, 'Хорошо', TIMESTAMPTZ '2025-12-24 00:00:00+00'),
  ('18000000-0000-0000-0000-000000000006', '17000000-0000-0000-0000-000000000003', '14000000-0000-0000-0000-000000000006', 82.0, 'Хорошо', TIMESTAMPTZ '2025-12-24 00:00:00+00'),
  ('18000000-0000-0000-0000-000000000007', '17000000-0000-0000-0000-000000000004', '14000000-0000-0000-0000-000000000007', 95.0, 'Отлично', TIMESTAMPTZ '2025-12-29 00:00:00+00'),
  ('18000000-0000-0000-0000-000000000008', '17000000-0000-0000-0000-000000000004', '14000000-0000-0000-0000-000000000008', 82.0, 'Хорошо', TIMESTAMPTZ '2025-12-29 00:00:00+00');

-- User accounts (admin + professors + students)
INSERT INTO "UserAccount" ("Id", "Username", "PasswordHash", "Role", "LinkedPersonId") VALUES
  ('19000000-0000-0000-0000-000000000001', 'admin', 'admin123', 'Admin', NULL),
  ('19000000-0000-0000-0000-000000000002', 'prof_igor', 'prof123', 'Professor', '13000000-0000-0000-0000-000000000001'),
  ('19000000-0000-0000-0000-000000000003', 'prof_elena', 'prof123', 'Professor', '13000000-0000-0000-0000-000000000002'),
  ('19000000-0000-0000-0000-000000000004', 'prof_oleg', 'prof123', 'Professor', '13000000-0000-0000-0000-000000000003'),
  ('19000000-0000-0000-0000-000000000005', 'prof_marina', 'prof123', 'Professor', '13000000-0000-0000-0000-000000000004'),
  ('19000000-0000-0000-0000-000000000006', 'stud_artem', 'stud123', 'Student', '14000000-0000-0000-0000-000000000001'),
  ('19000000-0000-0000-0000-000000000007', 'stud_nikita', 'stud123', 'Student', '14000000-0000-0000-0000-000000000002'),
  ('19000000-0000-0000-0000-000000000008', 'stud_polina', 'stud123', 'Student', '14000000-0000-0000-0000-000000000003'),
  ('19000000-0000-0000-0000-000000000009', 'stud_darya', 'stud123', 'Student', '14000000-0000-0000-0000-000000000004'),
  ('19000000-0000-0000-0000-000000000010', 'stud_kirill', 'stud123', 'Student', '14000000-0000-0000-0000-000000000005'),
  ('19000000-0000-0000-0000-000000000011', 'stud_anna', 'stud123', 'Student', '14000000-0000-0000-0000-000000000006'),
  ('19000000-0000-0000-0000-000000000012', 'stud_sofia', 'stud123', 'Student', '14000000-0000-0000-0000-000000000007'),
  ('19000000-0000-0000-0000-000000000013', 'stud_gleb', 'stud123', 'Student', '14000000-0000-0000-0000-000000000008');

-- Safety: sync identity sequences used by int PK tables.
SELECT setval(pg_get_serial_sequence('"Course"', 'Id'), GREATEST(COALESCE((SELECT MAX("Id") FROM "Course"), 0), 1), true);
SELECT setval(pg_get_serial_sequence('"Assignment"', 'Id'), GREATEST(COALESCE((SELECT MAX("Id") FROM "Assignment"), 0), 1), true);
SELECT setval(pg_get_serial_sequence('"Grade"', 'Id'), GREATEST(COALESCE((SELECT MAX("Id") FROM "Grade"), 0), 1), true);
SELECT setval(pg_get_serial_sequence('"Attendance"', 'Id'), GREATEST(COALESCE((SELECT MAX("Id") FROM "Attendance"), 0), 1), true);
